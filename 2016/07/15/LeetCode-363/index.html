<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description" content="学习总结"><meta name="viewport" content="width=device-width, initial-scale=1"><title>LeetCode 363 · Rosen</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">Rosen</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">LeetCode 363</h1><span class="post-time">Jul 15, 2016</span><div class="post-content"><h2 id="题目及分析"><a href="#题目及分析" class="headerlink" title="题目及分析"></a>题目及分析</h2><p>给一个非空r*c的矩阵（r&gt;&gt;c），找一个子矩阵使得该矩阵的和不超过给定的k（难度：hard）</p>
<p>暴力方法： 枚举两个子矩阵的两个端点，复杂度O(rrcc)<br>这个问题是另外几个问题的叠加</p>
<h2 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h2><p>题意： 给定一个一维数组A，求解A中和最大的子序列<br>思路： 动态规划，d[i]表示以A[i]为结尾的和最大序列的和，那么以A[i+1]结尾和最大序列则为：如果d[i]&gt;0,则序列接上A[i],否则A[i+1]自己为和最大序列。转移公式为：d[i+1] = d[i] &gt; 0 ? d[i] + A[i+1], A[i+1]。时间复杂度为O(n)。</p>
<h2 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h2><p>题意： 求一个二维矩阵A的子矩阵，使得子矩阵的所有元素的和最大<br>思路： 扫描线，每次固定两列L、R，表示子矩阵的左右两端，对于每一行求出L~R列的和(使用累积和相减)，即可得到一个一维数组A[row],问题转换为即可转换为问题1。固定。时间复杂度为O(min(ccr,rrc))。</p>
<h2 id="问题3"><a href="#问题3" class="headerlink" title="问题3"></a>问题3</h2><p>题意： 给定一个一维数组A，求解A中和不超过k的最大子序列<br>思路： 预处理一个累加和数组C，C[i]表示从sum(A[0~i])，则sum(A[i~j]) = C[j] - C[i-1]，问题可表述为：找到一对i，j使得T = C[j] - C[i-1] &lt;= k并且使T最大。 通过移项有： C[j] - k &lt;= C[i-1], 问题转换为： 对与每个j，在集合S = {0, C[1], C[2], … C[j-1]}中求一个小于 C[j] - K的最大值，如果使用二叉搜索树维护S，则该问题的复杂度为O(lgj)。总体复杂度O(nlgn)。</p>
<h2 id="本题"><a href="#本题" class="headerlink" title="本题"></a>本题</h2><p>明白了以上问题的解法，本题将迎刃而解。<br>首先，使用扫描线法每次固定两列（r&gt;&gt;c）L、R，求出每一行L～R列的和得到一个一维数组A，使用问题3中的方法找出A中和小于但最接近k的子序列，总体时间复杂度为：O(ccrlgr)</p>
<p>代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxSumSubmatrix</span><span class="params">(<span class="built_in">vector</span>&lt; <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt;&amp; matrix, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> row = matrix.size(), col = matrix[<span class="number">0</span>].size();</div><div class="line">        <span class="keyword">int</span> cum_matrix[row][col];</div><div class="line">        <span class="comment">//预处理，对每行累积求和</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; row; i++)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; col; j++)&#123;</div><div class="line">                <span class="keyword">if</span>(j == <span class="number">0</span>)cum_matrix[i][j] = matrix[i][j];</div><div class="line">                <span class="keyword">else</span> cum_matrix[i][j] = cum_matrix[i][j - <span class="number">1</span>] + matrix[i][j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> max_sum = <span class="number">-0x7fffffff</span>;</div><div class="line">        <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; cum_sum;</div><div class="line">        <span class="comment">//扫描线，固定两列，变成一个在以为数组中寻找最大不超过k的子序列</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; col; i++)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; col; j++)&#123;</div><div class="line">                <span class="keyword">int</span> f, tmp = <span class="number">0</span>;</div><div class="line">                cum_sum.clear();</div><div class="line">                <span class="comment">// 二分</span></div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; row; s++)&#123;</div><div class="line">                    cum_sum.insert(tmp);</div><div class="line">                    <span class="keyword">if</span>(i == <span class="number">0</span>) f = cum_matrix[s][j];</div><div class="line">                    <span class="keyword">else</span> f = cum_matrix[s][j] - cum_matrix[s][i - <span class="number">1</span>];</div><div class="line">                    tmp += f;</div><div class="line">                    <span class="comment">//set本身有序，可使用STL中upper_bound函数</span></div><div class="line">                    <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;::iterator iter = cum_sum.upper_bound(tmp-k<span class="number">-1</span>);</div><div class="line">                    <span class="keyword">if</span>(iter != cum_sum.end())&#123;</div><div class="line">                        max_sum = max(max_sum, tmp - *iter);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max_sum;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</div></article><div class="tags"><a href="/tags/动态规划/">动态规划</a><a href="/tags/扫描线/">扫描线</a><a href="/tags/LeetCode/">LeetCode</a><a href="/tags/Hard/">Hard</a><a href="/tags/STL/">STL</a><a href="/tags/二分查找/">二分查找</a><a href="/tags/算法/">算法</a></div><div class="paginator"><a href="/2016/07/14/序/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div data-thread-key="http://rosen.xyz/2016/07/15/LeetCode-363/index.html" data-title="LeetCode 363" data-url="http://rosen.xyz/2016/07/15/LeetCode-363/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "rosen" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section></section><footer><div class="copyright"><p>&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Rosen</span></p><p class="theme">Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/back2top.js"></script></html>